<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>比賽結果查詢</title>
</head>
<body>
    <h1>查詢比賽結果</h1>

    <label>日期：</label>
    <input type="date" id="matchDate"><br><br>

    <label>球隊名稱（可選）：</label>
    <input type="text" id="teamName" placeholder="輸入球隊名稱"><br><br>

    <button onclick="searchMatch()">查詢</button>
    <button onclick="location.href='dashboard.html'">回主畫面</button>

    <h2>結果：</h2>
    <div id="result"></div>

    <script>
        async function searchMatch() {
            const date = document.getElementById("matchDate").value;
            const teamName = document.getElementById("teamName").value.trim();
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = "";

            if (!date) {
                resultDiv.innerHTML = "<p>請輸入日期</p>";
                return;
            }

            try {
                const res = await fetch("http://127.0.0.1:5000/search/matches", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ date, team_name: teamName })
                });

                const data = await res.json();

                if (data.success) {
                    const matches = data.result;

                    if (!matches || matches.length === 0) {
                        resultDiv.innerHTML = "<p>找不到符合的比賽</p>";
                        return;
                    }

                    matches.forEach(m => {
                        const div = document.createElement("div");
                        div.innerHTML = `
                            <strong>比賽ID: ${m.match_id}</strong><br>
                            日期: ${m.date} | 時間: ${m.start_time}<br>
                            地點: ${m.location} | 天氣: ${m.weather || "未知"} | 溫度: ${m.temperature || "未知"}<br>
                            主隊: ${m.home_team_name} (${m.home_score}) vs 客隊: ${m.away_team_name} (${m.away_score})<br>
                            狀態: ${m.status} | 觀眾數: ${m.attendance || "未知"}
                            <hr>
                        `;
                        resultDiv.appendChild(div);
                    });
                } else {
                    resultDiv.innerHTML = "<p>查詢失敗：" + data.error + "</p>";
                }

            } catch (err) {
                resultDiv.innerHTML = "<p>發生錯誤：" + err + "</p>";
            }
        }
    </script>
</body>
</html>

